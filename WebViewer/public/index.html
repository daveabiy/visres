<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Experiment Visualization</title>
  <!-- QR code & touch libraries -->
  <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8/hammer.min.js"></script>

  <!-- <link rel="stylesheet" href="../src/styles/main.css"> -->

  <style>
    :root {
      /* Panel & text */
      --panel-bg: rgba(217, 230, 239, 0.85);
      --text-dark: #1a1a1a;

      /* Accents */
      --accent-blue: #00e5ff;
      --accent-magenta: #ff00d6;

      /* Shadows & glows */
      --soft-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
      --neon-glow-blue: 0 0 10px var(--accent-blue), 0 0 30px var(--accent-blue);
      --neon-glow-magenta: 0 0 6px var(--accent-magenta), 0 0 18px var(--accent-magenta);
    }

    /* full-screen galaxy stays behind */
    html, body {
      margin: 0px;
      padding: 0;
      height: 100%;
      overflow-x: hidden;
      background: #0a1026;
      font-family: Arial, sans-serif;
      color: var(--text-dark);
    }
    #starfield {
      position: fixed;
      top: 0; left: 0;
      width: 100vw; height: 100vh;
      z-index: 0;
      pointer-events: none;
    }

    /* your light panel for all text & controls */
    .container {
      position: relative;
      z-index: 1;
      margin: 2rem auto;
      padding: 2rem;
      max-width: 1400px;
      background: var(--panel-bg);
      backdrop-filter: blur(6px);
      border-radius: 12px;
      box-shadow: var(--soft-shadow);
    }

    /* Headings & text */
    h1, h2, h3, h4, h5, h6 {
      /* margin: 0 0 1rem; */
      color: hsl(235, 83%, 49%);
      margin-bottom: 2rem;
      text-align: center;
      text-shadow: 0 1px 2px rgba(0,0,0,0.1);
    }
    
    p {
      line-height: 1.6;
      color: var(--text-dark);
    }

    /* Experiment buttons */
    .experiment-list {
      display: flex;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 2rem;
    }
    .experiment-button {
      padding: 12px 28px;
      background: linear-gradient(90deg, var(--accent-blue) 0%, #1e2a78 100%);
      color: #fff;
      border: none;
      border-radius: 6px;
      font-size: 1.1em;
      font-weight: bold;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      cursor: pointer;
      transition: background 0.3s, transform 0.2s;
    }
    .experiment-button:hover {
      background: linear-gradient(90deg, #1e2a78 0%, var(--accent-blue) 100%);
      transform: translateY(-2px) scale(1.04);
    }

    /* Image grid */
    .images {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px,1fr));
      gap: 20px;
    }
    .image-container {
      position: relative;
      cursor: pointer;
    }
    .image-container img {
      width: 100%;
      max-width: 300px;
      height: 300px;
      object-fit: contain;
      background: rgba(217, 230, 239, 0.85),
      border-radius: 4px;
      box-shadow: var(--soft-shadow);
      transition: transform 0.3s;
    }
    .image-container:hover img {
      transform: scale(1.05);
    }
    .image-title {
      position: absolute;
      bottom: 0; left: 0; right: 0;
      background: var(--panel-bg);
      color: var(--text-dark);
      padding: 8px 0;
      font-size: 1em;
      text-align: center;
      opacity: 0;
      transition: opacity 0.3s;
    }
    .image-container:hover .image-title {
      opacity: 1;
    }

    /* QR & Share */
    .qr-container {
      position: fixed;
      bottom: 20px; right: 20px;
      background: var(--panel-bg);
      padding: 10px;
      border-radius: 8px;
      box-shadow: var(--soft-shadow);
      z-index: 2;
    }
    .share-button {
      position: fixed;
      bottom: 20px; left: 20px;
      background: var(--accent-blue);
      color: #fff;
      padding: 10px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      z-index: 2;
      transition: background 0.3s;
    }
    .share-button:hover {
      background: #005f8e;
    }

    /* Footer & Contact */
    footer {
      text-align: center;
      margin-top: 3rem;
      color: #666;
    }
    #contact, #contact a {
      color: var(--text-dark);
    }

    /* Modal remains unchanged, inheriting dark backdrop */
    .modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.9);
      z-index: 1000;
    }
    .modal-content {
      width: 90%; height: 90%;
      margin: 2% auto;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .modal-image {
      max-width: 100%; max-height: 80vh;
      object-fit: contain;
      transform-origin: center;
    }
    .close-modal {
      position: absolute; top: 15px; right: 35px;
      font-size: 40px; color: #fff; cursor: pointer;
    }

    /* Star styling */
    .star {
      position: absolute;
      border-radius: 50%;
      background: #fff;
      box-shadow: 0 0 8px 2px #fff, 0 0 20px 8px #3a6cf6;
      animation: twinkle 2s infinite alternate;
    }
    @keyframes twinkle {
      from { opacity: 0.6; }
      to   { opacity: 1;   }
    }

    /* Responsive tweaks (unchanged) */
    @media (max-width: 768px){
      .container { margin: 1rem; padding: 1rem; }
      .images { grid-template-columns: 1fr; gap: 10px; }
      .experiment-button { width: 100%; margin: 5px 0; }
      .share-button, .qr-container { bottom: 70px; left: 10px; right: auto; }
    }
  </style>
</head>
<body>
    <div class="container">
        <!-- About the Project section -->
        <section id="about-project" style="margin-bottom: 30px;">
            <h1>ForwardNET, Solving Inverse Problems in X-ray Imaging</h1>
            <h3>The Phase Retrieval Problem</h3>
            <p>
                The beams of PETRA III, P05 and P07, like many other beam lines, have various inverse problems involved in them. These include computed tomography, phase retrieval, deblurring due to lenses or fly-scan rotational blurs. ForwardNET is developed with this in mind.<br><br>
                The phase retrieval problem is a non-linear, ill-posed inverse problem. It is also an important step in X-ray imaging, a precursor to the tomographic reconstruction stage. Experiments involving micro and nanometer-sized objects usually have weak absorption and contrast. This is usually the case in most experiments taking place at high-energy big Synchrotron centers like DESY.<br><br>
                Based on the works of GanRec and Deep-Image Prior, this model combines different generative models, with a possibility of adding an adversarial network.
            </p>
            <div style="display: flex; flex-wrap: wrap; gap: 30px; justify-content: center; align-items: flex-start; margin-top: 30px;">
                <figure style="max-width: 350px; text-align: center;">
                    <img src="images/setup/setup.png" alt="Experimental Setup" style="width: 100%; max-width: 350px; height: auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);" class="zoomable">
                    <figcaption style="font-size: 0.95em; color: #555; margin-top: 8px;">Experimental setup for X-ray phase retrieval and tomography.</figcaption>
                </figure>
                <figure style="max-width: 400px; text-align: center;">
                    <img src="images/setup/architecture.png" alt="ForwardNET Architecture" style="width: 120%; max-width: 600px; height: auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);" class="zoomable">
                    <figcaption style="font-size: 0.95em; color: #555; margin-top: 3px;">ForwardNET architecture: Generator, Forward Operator, Discriminator, and Loss Function.</figcaption>
                </figure>
                
            </div>
        </section>
        <h1>Experiment Visualization</h1>
        <div class="experiment-list">
            <button class="experiment-button" onclick="showExperiment('Simulation')">Simulation</button>
            <button class="experiment-button" onclick="showExperiment('Sequential Learning')">Sequential Learning</button>
            <button class="experiment-button" onclick="showExperiment('Compact Support')">Compact Support</button>
        </div>
        <div id="experiment-details" class="experiment-details">
            <h2 id="experiment-name"></h2>
            <p id="experiment-description" style="font-size: 1.1em; color: #555; margin-bottom: 20px;"></p>
            <div class="images">
                <div class="image-container">
                    <img id="intensity-image" src="" alt="Example 1" class="hidden">
                    <div class="loading hidden">Loading...</div>
                    <div class="image-title" id="intensity-title"></div>
                    <!-- <figcaption style="font-size: 0.95em; color: #555; margin-top: 8px;">Letters and geometric objects</figcaption> -->
                </div>
                <div class="image-container">
                    <img id="phase-image" src="" alt="Example 2" class="hidden">
                    <div class="loading hidden">Loading...</div>
                    <div class="image-title" id="phase-title"></div>
                    <!-- <figcaption style="font-size: 0.95em; color: #555; margin-top: 8px;">QR codes</figcaption> -->
                
                </div>
                <div class="image-container">
                    <img id="attenuation-image" src="" alt="Example 3" class="hidden">
                    <div class="loading hidden">Loading...</div>
                    <div class="image-title" id="attenuation-title"></div>
                    <!-- <figcaption style="font-size: 0.95em; color: #555; margin-top: 8px;">Simualated Mg-based screw with noises</figcaption> -->
                
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for full-screen view -->
    <div id="imageModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <img id="modalImage" class="modal-image">
            <div class="image-controls">
                <button class="control-button" onclick="zoomIn()">Zoom In</button>
                <button class="control-button" onclick="zoomOut()">Zoom Out</button>
                <button class="control-button" onclick="resetZoom()">Reset</button>
            </div>
        </div>
    </div>

    <!-- Add gesture hint -->
    <div class="gesture-hint" id="gestureHint">
        Pinch to zoom, swipe to navigate
    </div>

    <!-- Add copyright footer -->
    <footer style="text-align:center; margin-top:40px; color:#888;">
        © 2025 Dawit Hailu. All images and content are protected. Do not reuse without permission.
    </footer>
    <!-- Add contact and logo section at the bottom -->
    <div style="display: flex; justify-content: space-between; align-items: center; max-width: 700px; margin: 40px auto 0 auto; padding: 20px 0;">
        <section id="contact" style="color:#007bff;text-align:left">
            <h2>Contact </h2>
            <p style="font-size:1.1em; color:#007bff; margin: 8px 0 2px 0;">Dawit Hailu</p>
            <p style="margin: 2px 0;"><a href="mailto:dawit.hailu@hereon.de" style="color:#007bff; text-decoration:none;">dawit.hailu@hereon.de</a></p>
            <p style="margin: 2px 0;">+49 1573 3656952</p>
            <p style="margin: 2px 0;"><a href="https://www.linkedin.com/in/dawitstranger/" target="_blank" rel="noopener" style="color:#007bff; text-decoration:none;">LinkedIn</a></p>
        </section>
        <figure style="max-width: 200px; text-align: right; margin: 0;">
            <img src="images/logo.png" alt="Helmholtz-Zentrum Hereon Logo" style="color:#007bff;width: 100%; max-width: 200px; height: auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); background: white;">
            <figcaption style="font-size: 0.95em; color: #555; margin-top: 8px;">Helmholtz-Zentrum Hereon</figcaption>
        </figure>
    </div>

    <!-- Starfield background -->
    <div class="starfield" id="starfield"></div>

    <script>
        const experimentImageMap = {
            "Simulation": "experiment1",
            "Sequential Learning": "experiment2",
            "Compact Support": "experiment3"
        };

        const experimentDescriptions = {
            "Sequential Learning": "Tooth data downsampled multiple times and reconstructed at each resolution.",
            "Compact Support": "Mg corrosion image with SMRL for improved background and compact support."
        };


        const experimentImageTitles = {
            "Simulation": [
                "Fig 1. Letters",
                "Fig 2. QR code",
                "Fig 3. Mg-based Screw"
            ],
            "Sequential Learning": [
                "Fig 1. Tooth Intensity",
                "Fig 2. Sequential Learning",
                "Fig 3. RGB Phase"
            ],
            "Compact Support": [
                "Fig 1. Input Intensity",
                "Fig 2. SMRL Variants",
                "Fig 3. Uncertainty Analysis"
            ]
        };


        let currentZoom = 1;
        let currentImageType = '';

        function handleImageError(img) {
            console.error('Image failed to load:', img.src);
            img.parentElement.querySelector('.loading').classList.add('hidden');
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.textContent = 'Failed to load image';
            img.parentElement.appendChild(errorDiv);
        }

        function showExperiment(experimentName) {
            currentExperiment = experimentName;
            document.getElementById('experiment-name').innerText = experimentName;
            document.getElementById('experiment-description').innerText = experimentDescriptions[experimentName] || '';
            const folder = experimentImageMap[experimentName];
            const imageTypes = ['intensity', 'phase', 'attenuation'];
            imageTypes.forEach((type, idx) => {
                const img = document.getElementById(`${type}-image`);
                const loading = img.parentElement.querySelector('.loading');
                const errorDiv = img.parentElement.querySelector('.error-message');
                const titleDiv = document.getElementById(`${type}-title`);
                if (errorDiv) errorDiv.remove();
                img.classList.add('hidden');
                loading.classList.remove('hidden');
                const imagePath = `images/${folder}/${type}.png`;
                img.onload = function() {
                    loading.classList.add('hidden');
                    img.classList.remove('hidden');
                };
                img.onerror = function() {
                    handleImageError(img);
                };
                img.src = imagePath;
                // Set the image title to the correct Fig info
                if (titleDiv) titleDiv.textContent = experimentImageTitles[experimentName][idx];
                // Set click handler for modal info
                img.parentElement.onclick = function() { openModal(type, idx); };
            });
        }

        function openModal(imageType) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            const img = document.getElementById(`${imageType}-image`);
            
            if (img.src) {
                modal.style.display = 'block';
                modalImg.src = img.src;
                currentImageType = imageType;
                currentZoom = 1;
                modalImg.style.transform = `scale(${currentZoom})`;
                initTouchGestures();
            }
        }

        function closeModal() {
            document.getElementById('imageModal').style.display = 'none';
        }

        function zoomIn() {
            currentZoom += 0.1;
            updateZoom();
        }

        function zoomOut() {
            currentZoom -= 0.1;
            updateZoom();
        }

        function resetZoom() {
            currentZoom = 1;
            updateZoom();
        }
        
        function updateZoom() {
            const modalImg = document.getElementById('modalImage');
            modalImg.style.transform = `scale(${currentZoom})`;
        }

        // Close modal when clicking outside the image
        window.onclick = function(event) {
            const modal = document.getElementById('imageModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Add keyboard controls
        document.addEventListener('keydown', function(event) {
            if (document.getElementById('imageModal').style.display === 'block') {
                switch(event.key) {
                    case 'Escape':
                        closeModal();
                        break;
                    case '+':
                        zoomIn();
                        break;
                    case '-':
                        zoomOut();
                        break;
                    case '0':
                        resetZoom();
                        break;
                }
            }
        });

        // Add touch gesture support
        function initTouchGestures() {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            
            if (modal && modalImg) {
                const hammer = new Hammer(modal);
                
                // Pinch to zoom
                hammer.get('pinch').set({ enable: true });
                hammer.on('pinch', function(e) {
                    currentZoom = Math.min(Math.max(currentZoom * e.scale, 0.5), 3);
                    updateZoom();
                });

                // Show gesture hint on mobile
                if (window.innerWidth <= 768) {
                    const hint = document.getElementById('gestureHint');
                    hint.style.display = 'block';
                    setTimeout(() => {
                        hint.style.display = 'none';
                    }, 3000);
                }
            }
        }

        // Starfield background generator
        function createStarfield(numStars = 100) {
            const starfield = document.getElementById('starfield');
            if (!starfield) return;
            for (let i = 0; i < numStars; i++) {
                const star = document.createElement('div');
                star.className = 'star';
                const size = Math.random() * 2 + 1;
                star.style.width = `${size}px`;
                star.style.height = `${size}px`;
                star.style.top = `${Math.random() * 100}vh`;
                star.style.left = `${Math.random() * 100}vw`;
                star.style.opacity = Math.random() * 0.7 + 0.3;
                star.style.animationDuration = `${1.5 + Math.random() * 2}s`;
                starfield.appendChild(star);
            }
        }

        // Initialize
        window.onload = function() {
            createStarfield();
            showExperiment('Simulation');
        };
    </script>
</body>
</html>