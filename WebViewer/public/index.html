<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Experiment Visualization</title>
    <!-- Add QR code library -->
    <script src="https://cdn.jsdelivr.net/npm/qrcode-generator@1.4.4/qrcode.min.js"></script>
    <!-- Add mobile-friendly touch library -->
    <script src="https://cdn.jsdelivr.net/npm/hammerjs@2.0.8/hammer.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            max-width: 1400px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 30px;
        }
        .experiment-list {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            justify-content: center;
        }
        .experiment-button {
            padding: 10px 20px;
            background-color: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .experiment-button:hover {
            background-color: #0056b3;
        }
        .experiment-details {
            text-align: center;
        }
        .images {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .image-container {
            position: relative;
            cursor: pointer;
        }
        .image-container img {
            width: 300px;
            height: 300px;
            object-fit: contain;
            background: #f0f0f0;
            border-radius: 4px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            transition: transform 0.3s ease;
        }
        .image-container:hover img {
            transform: scale(1.05);
        }
        .hidden {
            display: none;
        }
        .loading {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            color: #666;
        }
        .error-message {
            color: #dc3545;
            margin-top: 10px;
        }
        .image-title {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px;
            font-size: 14px;
            opacity: 0;
            transition: opacity 0.3s;
        }
        .image-container:hover .image-title {
            opacity: 1;
        }
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.9);
            z-index: 1000;
        }
        .modal-content {
            position: relative;
            width: 90%;
            height: 90%;
            margin: 2% auto;
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .modal-image {
            max-width: 100%;
            max-height: 80vh;
            object-fit: contain;
        }
        .close-modal {
            position: absolute;
            top: 15px;
            right: 35px;
            color: #f1f1f1;
            font-size: 40px;
            font-weight: bold;
            cursor: pointer;
        }
        .image-controls {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .control-button {
            padding: 5px 10px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
        }
        .control-button:hover {
            background: #0056b3;
        }
        .comparison-slider {
            position: relative;
            width: 100%;
            height: 300px;
            overflow: hidden;
        }
        .comparison-slider img {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            object-fit: contain;
        }
        .slider-handle {
            position: absolute;
            top: 0;
            bottom: 0;
            width: 4px;
            background: white;
            cursor: ew-resize;
        }
        .slider-handle::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 30px;
            height: 30px;
            background: white;
            border-radius: 50%;
        }
        /* Add QR code styles */
        .qr-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            background: white;
            padding: 10px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            z-index: 100;
        }
        .qr-code {
            width: 100px;
            height: 100px;
        }
        .qr-title {
            font-size: 12px;
            text-align: center;
            margin-top: 5px;
            color: #333;
        }
        .share-button {
            position: fixed;
            bottom: 20px;
            left: 20px;
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            z-index: 100;
        }
        .share-button:hover {
            background: #0056b3;
        }
        
        /* Mobile optimization */
        @media (max-width: 768px) {
            .container {
                padding: 10px;
                margin: 0;
                max-width: 100%;
            }
            .images {
                grid-template-columns: 1fr;
                gap: 10px;
            }
            .image-container {
                margin: 0;
            }
            .image-container img {
                width: 100%;
                height: auto;
                max-height: 300px;
            }
            .experiment-button {
                width: 100%;
                margin: 5px 0;
                padding: 15px;
                font-size: 16px;
            }
            .modal-content {
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 10px;
            }
            .modal-image {
                max-height: 70vh;
            }
            .image-controls {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: rgba(0, 0, 0, 0.8);
                padding: 10px;
                display: flex;
                justify-content: space-around;
            }
            .control-button {
                padding: 10px 20px;
                font-size: 16px;
            }
            .qr-container {
                position: fixed;
                bottom: 70px;
                right: 10px;
                background: white;
                padding: 5px;
                border-radius: 8px;
                box-shadow: 0 2px 4px rgba(0,0,0,0.1);
                z-index: 100;
            }
            .qr-code {
                width: 80px;
                height: 80px;
            }
            .share-button {
                position: fixed;
                bottom: 70px;
                left: 10px;
                padding: 10px 20px;
                font-size: 16px;
            }
            .share-options {
                position: fixed;
                bottom: 0;
                left: 0;
                right: 0;
                background: white;
                padding: 20px;
                display: none;
                flex-direction: column;
                gap: 10px;
                z-index: 1000;
            }
            .share-options.active {
                display: flex;
            }
            .share-option {
                padding: 15px;
                background: #f0f0f0;
                border: none;
                border-radius: 8px;
                font-size: 16px;
                text-align: left;
                display: flex;
                align-items: center;
                gap: 10px;
            }
            .share-option img {
                width: 24px;
                height: 24px;
            }
        }

        /* Add touch gesture hints */
        .gesture-hint {
            position: fixed;
            top: 10px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- About the Project section -->
        <section id="about-project" style="margin-bottom: 30px;">
            <h1>About the Project</h1>
            <p>
                The beams of PETRA III, P05 and P07, like many other beam lines, have various inverse problems involved in them. These include computed tomography, phase retrieval, deblurring due to lenses or fly-scan rotational blurs. ForwardNET is developed with this in mind.<br><br>
                The phase retrieval problem is a non-linear, ill-posed inverse problem. It is also an important step in X-ray imaging, a precursor to the tomographic reconstruction stage. Experiments involving micro and nanometer-sized objects usually have weak absorption and contrast. This is usually the case in most experiments taking place at high-energy big Synchrotron centers like DESY.<br><br>
                Based on the works of GanRec and Deep-Image Prior, this model combines different generative models, with a possibility of adding an adversarial network.
            </p>
            <div style="display: flex; flex-wrap: wrap; gap: 30px; justify-content: center; align-items: flex-start; margin-top: 30px;">
                <figure style="max-width: 400px; text-align: center;">
                    <img src="images/setup/architecture.png" alt="ForwardNET Architecture" style="width: 100%; max-width: 400px; height: auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                    <figcaption style="font-size: 0.95em; color: #555; margin-top: 8px;">ForwardNET architecture: Generator, Forward Operator, Discriminator, and Loss Function.</figcaption>
                </figure>
                <figure style="max-width: 350px; text-align: center;">
                    <img src="images/setup/setup.png" alt="Experimental Setup" style="width: 100%; max-width: 350px; height: auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08);">
                    <figcaption style="font-size: 0.95em; color: #555; margin-top: 8px;">Experimental setup for X-ray phase retrieval and tomography.</figcaption>
                </figure>
            </div>
        </section>
        <h1>Experiment Visualization</h1>
        <div class="experiment-list">
            <button class="experiment-button" onclick="showExperiment('Simulation')">Simulation</button>
            <button class="experiment-button" onclick="showExperiment('Sequential Learning')">Sequential Learning</button>
            <button class="experiment-button" onclick="showExperiment('Compact Support')">Compact Support</button>
        </div>
        <div id="experiment-details" class="experiment-details">
            <h2 id="experiment-name"></h2>
            <p id="experiment-description" style="font-size: 1.1em; color: #555; margin-bottom: 20px;"></p>
            <div class="images">
                <div class="image-container">
                    <img id="intensity-image" src="" alt="Intensity Image" class="hidden">
                    <div class="loading hidden">Loading...</div>
                    <div class="image-title" id="intensity-title"></div>
                </div>
                <div class="image-container">
                    <img id="phase-image" src="" alt="Phase Image" class="hidden">
                    <div class="loading hidden">Loading...</div>
                    <div class="image-title" id="phase-title"></div>
                </div>
                <div class="image-container">
                    <img id="attenuation-image" src="" alt="Attenuation Image" class="hidden">
                    <div class="loading hidden">Loading...</div>
                    <div class="image-title" id="attenuation-title"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal for full-screen view -->
    <div id="imageModal" class="modal">
        <div class="modal-content">
            <span class="close-modal" onclick="closeModal()">&times;</span>
            <img id="modalImage" class="modal-image">
            <div class="image-controls">
                <button class="control-button" onclick="zoomIn()">Zoom In</button>
                <button class="control-button" onclick="zoomOut()">Zoom Out</button>
                <button class="control-button" onclick="resetZoom()">Reset</button>
            </div>
        </div>
    </div>

    <!-- Add gesture hint -->
    <div class="gesture-hint" id="gestureHint">
        Pinch to zoom, swipe to navigate
    </div>

    <!-- Add copyright footer -->
    <footer style="text-align:center; margin-top:40px; color:#888;">
        © 2025 Dawit Hailu. All images and content are protected. Do not reuse without permission.
    </footer>
    <!-- Add contact and logo section at the bottom -->
    <div style="display: flex; justify-content: space-between; align-items: center; max-width: 700px; margin: 40px auto 0 auto; padding: 20px 0;">
        <section id="contact" style="text-align:left;">
            <h2>Contact</h2>
            <p style="font-size:1.1em; color:#333; margin: 8px 0 2px 0;">Dawit Hailu</p>
            <p style="margin: 2px 0;"><a href="mailto:dawit.hailu@hereon.de" style="color:#007bff; text-decoration:none;">dawit.hailu@hereon.de</a></p>
            <p style="margin: 2px 0;">+49 1573 3656952</p>
            <p style="margin: 2px 0;"><a href="https://www.linkedin.com/in/dawitstranger/" target="_blank" rel="noopener" style="color:#007bff; text-decoration:none;">LinkedIn</a></p>
        </section>
        <figure style="max-width: 200px; text-align: right; margin: 0;">
            <img src="images/logo.png" alt="Helmholtz-Zentrum Hereon Logo" style="width: 100%; max-width: 200px; height: auto; border-radius: 8px; box-shadow: 0 2px 8px rgba(0,0,0,0.08); background: white;">
            <figcaption style="font-size: 0.95em; color: #555; margin-top: 8px;">Helmholtz-Zentrum Hereon</figcaption>
        </figure>
    </div>

    <script>
        const experimentImageMap = {
            "Simulation": "experiment1",
            "Sequential Learning": "experiment2",
            "Compact Support": "experiment3"
        };

        const experimentDescriptions = {
            "Simulation": "[letters and geometric objects], [QR codes], and [Mg-based screw with noise].",
            "Sequential Learning": "Tooth data downsampled multiple times and reconstructed at each resolution.",
            "Compact Support": "Mg corrosion image with SMRL for improved background and compact support."
        };


        const experimentImageTitles = {
            "Simulation": [
                "Fig 1. Letters",
                "Fig 2. QR code",
                "Fig 3. Mg-based Screw"
            ],
            "Sequential Learning": [
                "Fig 1. Tooth Intensity",
                "Fig 2. Sequential Learning",
                "Fig 3. RGB Phase"
            ],
            "Compact Support": [
                "Fig 1. Input Intensity",
                "Fig 2. SMRL Variants",
                "Fig 3. Uncertainty Analysis"
            ]
        };


        let currentZoom = 1;
        let currentImageType = '';

        function handleImageError(img) {
            console.error('Image failed to load:', img.src);
            img.parentElement.querySelector('.loading').classList.add('hidden');
            const errorDiv = document.createElement('div');
            errorDiv.className = 'error-message';
            errorDiv.textContent = 'Failed to load image';
            img.parentElement.appendChild(errorDiv);
        }

        function showExperiment(experimentName) {
            currentExperiment = experimentName;
            document.getElementById('experiment-name').innerText = experimentName;
            document.getElementById('experiment-description').innerText = experimentDescriptions[experimentName] || '';
            const folder = experimentImageMap[experimentName];
            const imageTypes = ['intensity', 'phase', 'attenuation'];
            imageTypes.forEach((type, idx) => {
                const img = document.getElementById(`${type}-image`);
                const loading = img.parentElement.querySelector('.loading');
                const errorDiv = img.parentElement.querySelector('.error-message');
                const titleDiv = document.getElementById(`${type}-title`);
                if (errorDiv) errorDiv.remove();
                img.classList.add('hidden');
                loading.classList.remove('hidden');
                const imagePath = `images/${folder}/${type}.png`;
                img.onload = function() {
                    loading.classList.add('hidden');
                    img.classList.remove('hidden');
                };
                img.onerror = function() {
                    handleImageError(img);
                };
                img.src = imagePath;
                // Set the image title to the correct Fig info
                if (titleDiv) titleDiv.textContent = experimentImageTitles[experimentName][idx];
                // Set click handler for modal info
                img.parentElement.onclick = function() { openModal(type, idx); };
            });
        }

        function openModal(imageType) {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            const img = document.getElementById(`${imageType}-image`);
            
            if (img.src) {
                modal.style.display = 'block';
                modalImg.src = img.src;
                currentImageType = imageType;
                currentZoom = 1;
                modalImg.style.transform = `scale(${currentZoom})`;
                initTouchGestures();
            }
        }

        function closeModal() {
            document.getElementById('imageModal').style.display = 'none';
        }

        function zoomIn() {
            currentZoom = Math.min(currentZoom + 0.1, 3);
            updateZoom();
        }

        function zoomOut() {
            currentZoom = Math.max(currentZoom - 0.1, 0.5);
            updateZoom();
        }

        function resetZoom() {
            currentZoom = 1;
            updateZoom();
        }

        function updateZoom() {
            const modalImg = document.getElementById('modalImage');
            modalImg.style.transform = `scale(${currentZoom})`;
        }

        // Close modal when clicking outside the image
        window.onclick = function(event) {
            const modal = document.getElementById('imageModal');
            if (event.target === modal) {
                closeModal();
            }
        }

        // Add keyboard controls
        document.addEventListener('keydown', function(event) {
            if (document.getElementById('imageModal').style.display === 'block') {
                switch(event.key) {
                    case 'Escape':
                        closeModal();
                        break;
                    case '+':
                        zoomIn();
                        break;
                    case '-':
                        zoomOut();
                        break;
                    case '0':
                        resetZoom();
                        break;
                }
            }
        });

        // Add touch gesture support
        function initTouchGestures() {
            const modal = document.getElementById('imageModal');
            const modalImg = document.getElementById('modalImage');
            
            if (modal && modalImg) {
                const hammer = new Hammer(modal);
                
                // Pinch to zoom
                hammer.get('pinch').set({ enable: true });
                hammer.on('pinch', function(e) {
                    currentZoom = Math.min(Math.max(currentZoom * e.scale, 0.5), 3);
                    updateZoom();
                });

                // Show gesture hint on mobile
                if (window.innerWidth <= 768) {
                    const hint = document.getElementById('gestureHint');
                    hint.style.display = 'block';
                    setTimeout(() => {
                        hint.style.display = 'none';
                    }, 3000);
                }
            }
        }

        // Initialize
        window.onload = function() {
            showExperiment('Simulation');
        };
    </script>
</body>
</html>